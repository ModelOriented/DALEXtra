<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extension for DALEX package • DALEXtra</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="dalexverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="dalexverse-2.css" rel="stylesheet">
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Extension for DALEX package">
<meta property="og:description" content="Provides wrapper of scikit-learn machine learning models. In applied machine learning, there is a strong belief that we need to strike a balance between interpretability and accuracy. However, in field of the Interpretable Machine Learning, there are more and more new ideas for explaining black-box models, that are implemented in R. DALEXtra creates DALEX explainer for models created using Python, that may be used by any package from DryWhy.ai family.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
      <a class="navbar-mi2logo" href="http://DrWhy.AI/">
    <img src="https://github.com/ModelOriented/DrWhyTemplate/blob/master/inst/pkgdown/assets/drwhy_znak_violet_small.jpg?raw=true" alt="MI2" height="46" title="MI2"></a>
        <a class="navbar-brand" href="index.html">DALEXtra</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.1.7</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="dalextra" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dalextra" class="anchor"></a>DALEXtra</h1></div>

<p>An extension for DALEX package</p>
</div>
<div id="anaconda" class="section level1">
<h1 class="hasAnchor">
<a href="#anaconda" class="anchor"></a>Anaconda</h1>
<p>In order to be able to use some features associated with <code>DALEXtra</code>, Anaconda in needed. The easiest way to get it, is visting <a href="https://www.anaconda.com/distribution">Anconda website</a>. And choosing proper OS as it stands in the following picture. <img src="README_files/figure-gfm/anaconda1.png"> There is no big difference bewtween Python versions when downloading conda therefore it is recommended to choose Python 3.7 (newer Anaconda version) and then downloading python 2.7.</p>
<div id="windows" class="section level2">
<h2 class="hasAnchor">
<a href="#windows" class="anchor"></a>Windows</h2>
<p>Crucial thing is adding conda to PATH environment variable when using Windows. You can do it during installation, by marking this checkbox.</p>
<p><img src="README_files/figure-gfm/anaconda2.png"></p>
<p>or, if conda is already installed, by following <a href="https://stackoverflow.com/a/44597801/9717584">those instructions</a>.</p>
</div>
<div id="unix" class="section level2">
<h2 class="hasAnchor">
<a href="#unix" class="anchor"></a>Unix</h2>
<p>While using unixlike OS, adding conda to PATH is not required.</p>
</div>
</div>
<div id="installation-and-configuration" class="section level1">
<h1 class="hasAnchor">
<a href="#installation-and-configuration" class="anchor"></a>Installation and configuration</h1>
<p>Package can be installed with execution of the following code</p>
<pre><code>install.packages("devtools")
devtools::install_github("ModelOriented/DALEXtra")
devtools::install_github("ModelOriented/DALEX")</code></pre>
<p>It is recommended to install latests github version of DALEX</p>
<p>Package <code>reticulate</code> will be downloaded along with <code>DALEXtra</code> but if you seek for its latests version it can be downloaded here</p>
<pre><code><a href="https://rdrr.io/pkg/devtools/man/reexports.html">devtools::install_github("rstudio/reticulate")</a></code></pre>
<p>Packages useful with explanations</p>
<pre><code>devtools::install_github("ModelOriented/ingredients")
devtools::install_github("ModelOriented/iBreakDown")
devtools::install_github("ModelOriented/shapper")
devtools::install_github("ModelOriented/auditor")</code></pre>
<p><a href="https://modeloriented.github.io/DALEXtra/" class="uri">https://modeloriented.github.io/DALEXtra/</a></p>
</div>
<div id="demo" class="section level1">
<h1 class="hasAnchor">
<a href="#demo" class="anchor"></a>Demo</h1>
<p>Here we will present short use case for our package and its compatibility with Python</p>
<div id="loading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-data" class="anchor"></a>Loading data</h2>
<p>First we need data, explainer is useless without them. Thing is Python object does not store training data so always have to proviede dataset. Feel free to use those attached to <code>DALEX</code> package or those stored in <code>DALEXtra</code> files.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">titanic_test &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"titanic_test.csv"</span>, <span class="dt">package =</span> <span class="st">"DALEXtra"</span>))</a></code></pre></div>
<p>Keep in mind that that dataframe includes targer variable (18th column) and scikit-learn models do not like it</p>
</div>
<div id="creating-explainer" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-explainer" class="anchor"></a>Creating explainer</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DALEXtra)</a>
<a class="sourceLine" id="cb5-2" title="2">explainer &lt;-<span class="st"> </span><span class="kw"><a href="reference/explain_scikitlearn.html">explain_scikitlearn</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"scikitlearn.pkl"</span>, <span class="dt">package =</span> <span class="st">"DALEXtra"</span>),</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="dt">yml =</span> <span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"testing_environment.yml"</span>, <span class="dt">package =</span> <span class="st">"DALEXtra"</span>), </a>
<a class="sourceLine" id="cb5-4" title="4"><span class="dt">data =</span> titanic_test[,<span class="dv">1</span><span class="op">:</span><span class="dv">17</span>], <span class="dt">y =</span> titanic_test<span class="op">$</span>survived)</a></code></pre></div>
<pre><code>## Preparation of a new explainer is initiated
##   -&gt; model label       :  scikitlearn_model  ([33mdefault[39m)
##   -&gt; data              :  524  rows  17  cols 
##   -&gt; target variable   :  524  values 
##   -&gt; predict function  :  yhat.scikitlearn_model  will be used ([33mdefault[39m)
##   -&gt; predicted values  :  numerical, min =  0.02086126 , mean =  0.288584 , max =  0.9119996  
##   -&gt; residual function :  difference between y and yhat ([33mdefault[39m)
##   -&gt; residuals         :  numerical, min =  -0.8669431 , mean =  0.02248468 , max =  0.9791387  
## [32mA new explainer has been created![39m</code></pre>
<p>Creating exlainer from scikit-learn Python model is very simple thanks to <code>DALEXtra</code>. The only thing you need to provide is path to pickle and, if necessery, something that lets recognize Python environment. It may be .yml file with packages specification, name of existing conda environment or path to Python virtual environment. Execution of <code>scikitlearn_explain</code> only with .pkl file and data will cause usage of default Python.</p>
</div>
<div id="creating-explanations" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-explanations" class="anchor"></a>Creating explanations</h2>
<p>Now with explainer ready we can use any of DrWhy.ai universe tools to make explanations. Here is a small demo</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DALEX)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">model_performance</span>(explainer))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ingredients)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">feature_importance</span>(explainer))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">describe</span>(<span class="kw">feature_importance</span>(explainer))</a></code></pre></div>
<pre><code>## The number of important variables for scikitlearn_model's prediction is 2 out of 17. 
##  Variables gender.female, gender.male have the highest importantance.</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(iBreakDown)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">break_down</span>(explainer, titanic_test[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">17</span>]))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">describe</span>(<span class="kw">break_down</span>(explainer, titanic_test[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">17</span>]))</a></code></pre></div>
<pre><code>## Scikitlearn_model predicts, that the prediction for the selected instance is 0.132 which is lower than the average model prediction.
##  
## The most important variables that decrease the prediction are class.3rd, gender.female. 
## The most important variable that increase the prediction is age.
##  
## Other variables are with less importance. The contribution of all other variables is -0.108 .</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(shapper)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">shap</span>(explainer, titanic_test[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">17</span>]))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(auditor)</a>
<a class="sourceLine" id="cb15-2" title="2">eval &lt;-<span class="st"> </span><span class="kw">model_evaluation</span>(explainer)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">plot_roc</span>(eval)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-5.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Predictions with newdata</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(explainer, titanic_test[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">17</span>])</a></code></pre></div>
<pre><code>##  [1] 0.3565896 0.1321947 0.7638813 0.1037486 0.1265221 0.2949228 0.1421281
##  [8] 0.1421281 0.4154695 0.1321947</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/ModelOriented/DALEXtra/issues">https://​github.com/​ModelOriented/​DALEXtra/​issues</a>
</li>
<li>Source code at <br><a href="https://github.com/ModelOriented/DALEXtra">https://​github.com/​ModelOriented/​DALEXtra</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Szymon Maksymiuk <br><small class="roles"> Author, maintainer </small>  </li>
<li>Przemyslaw Biecek <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8423-1823" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/ModelOriented/DALEXtra"><img src="https://travis-ci.org/ModelOriented/DALEXtra.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/github/ModelOriented/DALEXtra?branch=master"><img src="https://img.shields.io/codecov/c/github/ModelOriented/DALEXtra/master.svg" alt="Coverage Status"></a></li>
</ul>
</div>
</div>

</div>



      <footer><div class="author">
  <p>
    Developed by Szymon Maksymiuk, Przemyslaw Biecek.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
